<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            color: #E0E0E0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex; flex-direction: column; height: 100vh; margin: 0; padding: 12px;
            box-sizing: border-box; background-color: #2b2b2b; gap: 12px; overflow: hidden;
        }

        #module-settings { flex: 0 0 auto; }
        #toggle-key-btn {
            background-color: transparent; color: #aaa; border: 1px solid #444; padding: 6px 12px;
            border-radius: 4px; cursor: pointer; font-size: 12px; width: 100%; text-align: left;
            display: flex; justify-content: space-between;
        }
        #toggle-key-btn:hover { background-color: #383838; color: #fff; }
        #key-panel { display: none; background-color: #222; padding: 12px; border-radius: 4px; border: 1px solid #444; margin-top: 8px; }

        .api-toggle-group { display: flex; gap: 15px; margin-bottom: 12px; font-size: 13px; color: #ccc; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .api-toggle-group label { cursor: pointer; display: flex; align-items: center; gap: 4px; margin-bottom: 0;}

        .setting-row { margin-bottom: 8px; }
        .setting-row label { font-size: 12px; color: #999; margin-bottom: 4px; }
        input[type="text"], input[type="password"] {
            width: 100%; background-color: #111; color: #fff; border: 1px solid #555;
            padding: 6px; border-radius: 4px; box-sizing: border-box; font-size: 12px;
        }
        input:focus { outline: none; border-color: #1473E6; }

        #save-key-btn { background-color: #28a745; margin-top: 8px; width: 100%; }
        #save-key-btn:hover { background-color: #218838; }

        #module-input { flex: 0 0 auto; background-color: #383838; padding: 12px; border-radius: 6px; border: 1px solid #444; }
        #module-output {
            flex: 1 1 auto; min-height: 100px; display: flex; flex-direction: column;
            background-color: #383838; padding: 12px; border-radius: 6px; border: 1px solid #444;
        }
        #module-image-output {
            display: none; flex: 0 0 280px; flex-direction: column;
            background-color: #383838; padding: 12px; border-radius: 6px; border: 1px solid #444;
        }

        label { font-size: 13px; font-weight: bold; color: #aaa; margin-bottom: 6px; display: block; }
        #output-area { flex: 1; overflow-y: auto; background-color: #222; padding: 12px; border-radius: 4px; border: 1px solid #111; font-size: 13px; line-height: 1.6; }
        textarea { width: 100%; height: 60px; background-color: #222; color: white; border: 1px solid #111; border-radius: 4px; padding: 8px; resize: vertical; box-sizing: border-box; font-size: 13px; }
        textarea:focus { outline: none; border-color: #1473E6; }
        .checkbox-wrapper { margin-top: 10px; display: flex; align-items: center; gap: 6px; font-size: 13px; color: #ccc; }
        .btn-group { display: flex; gap: 10px; margin-top: 12px; }
        button { background-color: #1473E6; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 13px; }
        button:hover { background-color: #0d66d0; }
        #send-btn { flex-grow: 1; }
        #clear-btn { background-color: #555; flex-grow: 0; width: 80px; }
        #clear-btn:hover { background-color: #666; }

        #image-preview-container { flex: 1; overflow-y: auto; display: flex; flex-direction: column; align-items: center; background-color: #222; padding: 12px; border-radius: 4px; border: 1px solid #111; position: relative; }
        #image-placeholder { flex: 1; display: flex; justify-content: center; align-items: center; color: #777; font-size: 13px; }
        #generated-image { max-width: 100%; max-height: 200px; border-radius: 4px; border: 2px solid #555; display: none; }
        #image-meta-area { font-size: 12px; color: #aaa; margin-top: 6px; text-align: center; display: none; }
        #output-area strong { color: #fff; }
    </style>
</head>
<body>
    <div id="module-settings">
        <button id="toggle-key-btn">âš™ï¸ æ¥å£ä¸æ¨¡å‹é…ç½® (ç‚¹å‡»å±•å¼€) <span>â–¼</span></button>
        <div id="key-panel">
            <div class="api-toggle-group">
                <label><input type="radio" name="api-type" value="official"> å®˜æ–¹ç›´è¿ API</label>
                <label><input type="radio" name="api-type" value="thirdparty" checked> ç¬¬ä¸‰æ–¹ä»£ç† API</label>
            </div>

            <div id="official-settings" style="display: none;">
                <div class="setting-row">
                    <label>Google å®˜æ–¹ API Key (AI Studio)ï¼š</label>
                    <input type="password" id="official-key-input" placeholder="è¾“å…¥ API Key...">
                </div>
            </div>

            <div id="thirdparty-settings">
                <div class="setting-row">
                    <label>ä»£ç†æ¥å£åœ°å€ (URL)ï¼š</label>
                    <input type="text" id="tp-url-input" placeholder="å¦‚ï¼šhttps://api.openai.com">
                </div>
                <div class="setting-row">
                    <label>æ¨¡å‹åç§° (Model)ï¼š</label>
                    <input type="text" id="tp-model-input" placeholder="å¦‚ï¼šgemini-2.5-pro æˆ– gpt-4o">
                </div>
                <div class="setting-row">
                    <label>ä»£ç† API Keyï¼š</label>
                    <input type="password" id="tp-key-input" placeholder="è¾“å…¥ä»£ç†å•†æä¾›çš„ sk-xxxxxxxx...">
                </div>
            </div>

            <button id="save-key-btn">ğŸ’¾ ä¿å­˜é…ç½®å¹¶éšè—</button>
        </div>
    </div>

    <div id="module-input">
        <label>1. ä½ çš„è®¾è®¡éœ€æ±‚æˆ–é—®é¢˜</label>
        <textarea id="prompt-input" placeholder="è¾“å…¥éœ€æ±‚ï¼ˆä¾‹å¦‚ï¼šå¸®æˆ‘ç»™è¿™æ®µæ–‡æ¡ˆæ–­å¥å¹¶æ¨èå­—ä½“ï¼Œæˆ–è€…ï¼šå¸®æˆ‘çœ‹çœ‹å½“å‰ç”»é¢çš„è°ƒè‰²å’Œæ„å›¾æ€ä¹ˆä¼˜åŒ–ï¼‰..."></textarea>
        <div class="checkbox-wrapper">
            <input type="checkbox" id="include-canvas">
            <label for="include-canvas">é™„å¸¦å‘é€å½“å‰çš„ PS ç”»é¢è¿›è¡Œè¯Šæ–­</label>
        </div>
        <div class="btn-group">
            <button id="send-btn">å‘é€ç»™ AI</button>
            <button id="clear-btn">æ¸…ç©º</button>
        </div>
    </div>
    <div id="module-output">
        <label>2. AI è¯Šæ–­ä¸ä¼˜åŒ–å»ºè®®</label>
        <div id="output-area">ç­‰å¾…è¯Šæ–­...</div>
    </div>
    <div id="module-image-output">
        <label>3. AI ç”Ÿæˆç»“æœ</label>
        <div id="image-preview-container">
            <div id="image-placeholder">ç­‰å¾…ç”Ÿæˆ...</div>
            <img id="generated-image" src="" alt="AI ç”Ÿæˆç»“æœ">
            <div id="image-meta-area">
                <span id="image-dimensions">å°ºå¯¸: é€‚é…ç”»å¸ƒ</span>
                <button id="send-to-ps-btn" style="margin-left: 10px;">å‘é€åˆ° PS</button>
            </div>
        </div>
    </div>
    <script src="index.js"></script>
</body>
</html>